// React import not needed with react-jsx runtime
import type { Meta, StoryObj } from '@storybook/react';
// Import from local file to avoid npm package dependency issues
import { StoryUIPanel } from './StoryUIPanel';

const meta = {
  title: 'Story UI/Story Generator',
  component: StoryUIPanel,
  parameters: {
    layout: 'fullscreen',
    docs: {
      description: {
        component: `
Story UI Panel connects to the MCP server running on port 4101.

This design system agnostic approach works with any component library.
Environment: React + Mantine

To generate components, simply describe what you want in natural language.
        `
      }
    }
  },
} satisfies Meta<typeof StoryUIPanel>;

export default meta;
type Story = StoryObj<typeof meta>;

export const Default: Story = {
  render: () => {
    // Set the port for this environment (4101 for React+Mantine)
    if (typeof window !== 'undefined') {
      // Check for URL parameter override first
      const urlParams = new URLSearchParams(window.location.search);
      const mcpPortParam = urlParams.get('mcp-port');

      if (mcpPortParam) {
        (window as any).STORY_UI_MCP_PORT = mcpPortParam;
      } else {
        // Default to port 4101 for this environment
        (window as any).STORY_UI_MCP_PORT = '4101';
      }
    }

    return <StoryUIPanel />;
  }
};
